Solutions of Q2:
Graph theory: 16000
The probability distribution: naive practice cannot work.
