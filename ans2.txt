Solutions of Q2:
Graph theory (analytic): 16000
The probability distribution: naive practice cannot work.
